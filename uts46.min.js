!function(t,n){"function"==typeof define&&define.amd?define(["punycode","./idna-map"],(function(t,e){return n(t,e)})):"object"==typeof exports?module.exports=n(require("punycode"),require("./idna-map")):t.uts46=n(t.punycode,t.idna_map)}(this,(function(t,n){function e(e,r,o){const i=[],a=t.ucs2.decode(e);for(let s=0;s<a.length;s++){const c=a[s],l=t.ucs2.encode([a[s]]),u=n.mapChar(c),h=u>>23,d=u>>21&3,f=u>>5&65535,p=31&u,w=n.mapStr.substr(f,p);if(console.log({label:e,chars:a,cp:c,ch:l,composite:u,flags:h,kind:d,index:f,length:p,value:w}),0===d||r&&1&h)throw new Error("Illegal char "+l);1===d?i.push(w):2===d?i.push(o?w:l):3===d&&i.push(l)}return i.join("").normalize("NFC")}function r(n,r,i){void 0===i&&(i=!1);let a=e(n,i,r).split(".");return a=a.map((function(n){return n.startsWith("xn--")?o(n=t.decode(n.substring(4)),i,!1):o(n,i,r),n})),a.join(".")}function o(t,r,o){if("-"===t[2]&&"-"===t[3])throw new Error("Failed to validate "+t);if(t.startsWith("-")||t.endsWith("-"))throw new Error("Failed to validate "+t);if(t.includes("."))throw new Error("Failed to validate "+t);if(e(t,r,o)!==t)throw new Error("Failed to validate "+t);const i=t.codePointAt(0);if(n.mapChar(i)&2<<23)throw new Error("Label contains illegal character: "+i)}function i(n,e){void 0===e&&(e={});const o=!("transitional"in e)||e.transitional,i="useStd3ASCII"in e&&e.useStd3ASCII,a="verifyDnsLength"in e&&e.verifyDnsLength,s=r(n,o,i).split(".").map(t.toASCII),c=s.join(".");let l;if(a){if(c.length<1||c.length>253)throw new Error("DNS name has wrong length: "+c);for(l=0;l<s.length;l++){const t=s[l];if(t.length<1||t.length>63)throw new Error("DNS label has wrong length: "+t)}}return c}function a(t,n){void 0===n&&(n={});return r(t,!1,"useStd3ASCII"in n&&n.useStd3ASCII)}return{toUnicode:a,toAscii:i,convert:function(t){const n=Array.isArray(t);n||(t=[t]);const e={IDN:[],PC:[]};return t.forEach((t=>{let n,r;try{n=i(t,{transitional:!t.match(/\.(?:be|ca|de|fr|pm|re|swiss|tf|wf|yt)\.?$/)}),r={PC:n,IDN:a(n)}}catch(n){r={PC:t,IDN:t}}e.PC.push(r.PC),e.IDN.push(r.IDN)})),n?e:{IDN:e.IDN[0],PC:e.PC[0]}}}}));